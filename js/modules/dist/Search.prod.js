"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _jquery=_interopRequireDefault(require("jquery"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,a){for(var s=0;s<a.length;s++){var t=a[s];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function _createClass(e,a,s){return a&&_defineProperties(e.prototype,a),s&&_defineProperties(e,s),e}var Search=function(){function e(){_classCallCheck(this,e),this.addSearchHTML(),this.resultsDiv=(0,_jquery.default)("#search-overlay__results"),this.openButton=(0,_jquery.default)(".js-search-trigger"),this.closeButton=(0,_jquery.default)(".search-overlay__close"),this.searchOverlay=(0,_jquery.default)(".search-overlay"),this.searchField=(0,_jquery.default)("#search-term"),this.events(),this.isOverlayOpen=!1,this.isSpinnerVisible=!1,this.previosValue,this.typingTimer}return _createClass(e,[{key:"events",value:function(){this.openButton.on("click",this.openOverlay.bind(this)),this.closeButton.on("click",this.closeOverlay.bind(this)),(0,_jquery.default)(document).on("keydown",this.keyPressDispatcher.bind(this)),this.searchField.on("keyup",this.typingLogic.bind(this))}},{key:"typingLogic",value:function(){this.searchField.val()!=this.previosValue&&(clearTimeout(this.typingTimer),this.searchField.val()?(this.isSpinnerVisible||(this.resultsDiv.html('<div class="spinner-loader"></div>'),this.isSpinnerVisible=!0),this.typingTimer=setTimeout(this.getResults.bind(this),1e3)):(this.resultsDiv.html(""),this.isSpinnerVisible=!1)),this.previosValue=this.searchField.val()}},{key:"getResults",value:function(){var a=this;_jquery.default.getJSON(newTestData.root_url+"/wp-json/newTest/v1/search?term="+this.searchField.val(),function(e){a.resultsDiv.html('\n          <div class="row">\n            <div class="one-third">\n              <h2 class="search-overlay__section-title">General Information</h2>\n              '.concat(e.generalInfo.length?'<ul class="link-list min-list">':"<p>No general information matches that search.</p>","\n                ").concat(e.generalInfo.map(function(e){return'<li><a href="'.concat(e.permalink,'">').concat(e.title,"</a> ").concat("post"==e.postType?"by ".concat(e.authorName):"","</li>")}).join(""),"\n              ").concat(e.generalInfo.length?"</ul>":"",'\n            </div>\n            <div class="one-third">\n              <h2 class="search-overlay__section-title">Programs</h2>\n              ').concat(e.programs.length?'<ul class="link-list min-list">':'<p>No programs match that search. <a href="'.concat(newTestData.root_url,'/programs">View all programs</a></p>'),"\n                ").concat(e.programs.map(function(e){return'\n                      <li><a href="'.concat(e.permalink,'">').concat(e.title,"</a></li>")}).join(""),"\n              ").concat(e.programs.length?"</ul>":"",'\n  \n              <h2 class="search-overlay__section-title">Professors</h2>\n              ').concat(e.professors.length?'<ul class="link-list min-list professor-card">':'<p>No professors match that search. <a href="'.concat(newTestData.root_url,'/professors">View all professors</a></p>'),"\n                ").concat(e.professors.map(function(e){return' <li class="professor-card__list-item">\n                      <a class="professor-card" href="'.concat(e.permalink,'">\n                          <img class="professor-card__image" src="').concat(e.thumbnail,'">\n                          <span class="professor-card__name">').concat(e.title,"</span>\n                      </a>\n                  </li>")}).join(""),"\n              ").concat(e.professors.length?"</ul>":"",'\n  \n            </div>\n            <div class="one-third">\n              <h2 class="search-overlay__section-title">Campuses</h2>\n              ').concat(e.campuses.length?'<ul class="link-list min-list">':'<p>No campuses match that search. <a href="'.concat(newTestData.root_url,'/campuses">View all campuses</a></p>'),"\n                ").concat(e.campuses.map(function(e){return'<li><a href="'.concat(e.permalink,'">').concat(e.title,"</a></li>")}).join(""),"\n              ").concat(e.campuses.length?"</ul>":"",'\n  \n              <h2 class="search-overlay__section-title">Events</h2>\n              ').concat(e.events.length?"":'<p>No events match that search. <a href="'.concat(newTestData.root_url,'/events">View all events</a></p>'),"\n                ").concat(e.events.map(function(e){return'\n                  <div class="event-summary">\n                    <a class="event-summary__date t-center" href="'.concat(e.permalink,'">\n                      <span class="event-summary__month">').concat(e.month,'</span>\n                      <span class="event-summary__day">').concat(e.day,'</span>  \n                    </a>\n                    <div class="event-summary__content">\n                      <h5 class="event-summary__title headline headline--tiny"><a href="').concat(e.permalink,'">').concat(e.title,"</a></h5>\n                      <p>").concat(e.description,' <a href="').concat(e.permalink,'" class="nu gray">Learn more</a></p>\n                    </div>\n                  </div>\n                ')}).join(" "),"\n            </div>\n          </div>\n        ")),a.isSpinnerVisible=!1})}},{key:"keyPressDispatcher",value:function(e){18!=e.keyCode||this.isOverlayOpen||(0,_jquery.default)("input,textarea").is(":focus")?27==e.keyCode&&this.isOverlayOpen&&this.closeOverlay():this.openOverlay()}},{key:"openOverlay",value:function(){var e=this;this.searchOverlay.addClass("search-overlay--active"),setTimeout(function(){e.searchField.focus()},500),(0,_jquery.default)("body").addClass("body-no-scroll"),this.isOverlayOpen=!0}},{key:"closeOverlay",value:function(){this.searchOverlay.removeClass("search-overlay--active"),(0,_jquery.default)("body").removeClass("body-no-scroll"),this.isOverlayOpen=!1}},{key:"addSearchHTML",value:function(){(0,_jquery.default)("body").append('\n    <div class="search-overlay">\n       <div class="search-overlay__top">\n           <div class="container">\n               <i class="fa fa-search search-overlay__icon" aria-hidden="true"></i>\n               <input type="text" placeholder="What Are You Looking For?!" id="search-term" class="search-term">\n               <i class="fa fa-window-close search-overlay__close search-overlay__icon" aria-hidden="true"></i>\n           </div>\n       </div>\n       <div class="container">\n           <div id="search-overlay__results">\n\n           </div>\n       </div>\n     </div>\n     ')}}]),e}(),_default=Search;exports.default=_default;