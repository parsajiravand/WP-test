"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _jquery=_interopRequireDefault(require("jquery"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var MyNotes=function(){function e(){_classCallCheck(this,e),this.events()}return _createClass(e,[{key:"events",value:function(){(0,_jquery.default)("#my-notes").on("click",".delete-note",this.deleteNote),(0,_jquery.default)("#my-notes").on("click",".edit-note",this.editNote.bind(this)),(0,_jquery.default)("#my-notes").on("click",".update-note",this.updateNote.bind(this)),(0,_jquery.default)(".submit-note").on("click",this.createNote.bind(this))}},{key:"editNote",value:function(e){var t=(0,_jquery.default)(e.target).parents("li");"editable"==t.data("state")?this.makeNoteReadonly(t):this.makeNoteEditable(t)}},{key:"makeNoteEditable",value:function(e){e.find(".edit-note").html('<i class="fa fa-times" aria-hidden="true"></i>Cansel'),e.find(".note-title-field,.note-body-field").removeAttr("readonly").addClass("note-active-field"),e.find(".update-note").addClass("update-note--visible"),e.data("state","editable")}},{key:"makeNoteReadonly",value:function(e){e.find(".edit-note").html('<i class="fa fa-pencil" aria-hidden="true"></i>Edit'),e.find(".note-title-field,.note-body-field").attr("readonly","readonly").removeClass("note-active-field"),e.find(".update-note").removeClass("update-note--visible"),e.data("state","cancel")}},{key:"updateNote",value:function(e){var t=this,n=(0,_jquery.default)(e.target).parents("li"),a={title:n.find(".note-title-field").val(),content:n.find(".note-body-field").val()};_jquery.default.ajax({beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",newTestData.nonce)},url:newTestData.root_url+"/wp-json/wp/v2/note/"+n.data("id"),type:"POST",data:a,success:function(){t.makeNoteReadonly(n)},error:function(e){console.log(e),console.log("Error Sorry :(")}})}},{key:"deleteNote",value:function(e){var t=(0,_jquery.default)(e.target).parents("li");_jquery.default.ajax({beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",newTestData.nonce)},url:newTestData.root_url+"/wp-json/wp/v2/note/"+t.data("id"),type:"DELETE",success:function(){t.slideUp()},error:function(e){console.log(e),console.log("Error Sorry :(")}})}},{key:"createNote",value:function(){var e={title:(0,_jquery.default)(".new-note-title").val(),content:(0,_jquery.default)(".new-note-body").val(),status:"publish"};_jquery.default.ajax({beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",newTestData.nonce)},url:newTestData.root_url+"/wp-json/wp/v2/note/",type:"POST",data:e,success:function(e){console.log(e),(0,_jquery.default)(".new-note-title,.new-note-body").val(""),(0,_jquery.default)('\n        <li data-id="'.concat(e.id,'">\n          <input readonly type="text" value="').concat(e.content.raw,'" class="note-title-field">\n          <span class="edit-note"><i class="fa fa-pencil" aria-hidden="true"></i>Edit</span>\n          <span class="delete-note"><i class="fa fa-trash-o" aria-hidden="true"></i>Delete</span>\n  \n          <textarea readonly class="note-body-field">').concat(e.content.rendered,'</textarea>\n  \n          <span class="update-note btn btn--blue btn--small"><i class="fa fa-arrow-right"\n                  aria-hidden="true"></i>Save</span>\n\n        </li>\n        ')).prependTo("#my-notes").hide().slideDown()},error:function(e){console.log(e),console.log("Error Sorry :(")}})}},{key:"deleteNote",value:function(e){var t=(0,_jquery.default)(e.target).parents("li");_jquery.default.ajax({beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",newTestData.nonce)},url:newTestData.root_url+"/wp-json/wp/v2/note/"+t.data("id"),type:"DELETE",success:function(){t.slideUp()},error:function(e){console.log(e),console.log("Error Sorry :(")}})}}]),e}(),_default=MyNotes;exports.default=MyNotes;